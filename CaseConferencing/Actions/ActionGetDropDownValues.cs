/* 
 This source code (the "Generated Software") is generated by the OutSystems Platform 
 and is licensed by OutSystems (http://www.outsystems.com) to You solely for testing and evaluation 
 purposes, unless You and OutSystems have executed a specific agreement covering the use terms and 
 conditions of the Generated Software, in which case such agreement shall apply. 
*/

using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.Runtime.Serialization;
using System.Reflection;
using System.Text;
using System.Text.RegularExpressions;
using OutSystems.HubEdition.RuntimePlatform;
using OutSystems.HubEdition.RuntimePlatform.Sms;
using OutSystems.HubEdition.RuntimePlatform.Log;
using OutSystems.HubEdition.RuntimePlatform.Db;
using OutSystems.Internal.Db;
using OutSystems.HubEdition.RuntimePlatform.Email;
using OutSystems.HubEdition.RuntimePlatform.Web;
using OutSystems.RuntimeCommon;
using OutSystems.ObjectKeys;
using System.Resources;

namespace ssCaseConferencing {

	public partial class Actions {
		public class lcvGetDropDownValues: VarsBag {
			/// <summary>
			/// Variable <code>varLcStartOfMonth</code> that represents the Service Studio local variable
			///  <code>StartOfMonth</code> <p>Description: </p>
			/// </summary>
			public DateTime varLcStartOfMonth = new DateTime(1900, 1, 1, 0, 0, 0);

			/// <summary>
			/// Variable <code>varLcStudentAttendanceDropDownRecord</code> that represents the Service Studio local
			///  variable <code>StudentAttendanceDropDownRecord</code> <p>Description: </p>
			/// </summary>
			public RCAttendancePeriodDropDownRecord varLcStudentAttendanceDropDownRecord = new RCAttendancePeriodDropDownRecord(null);

			/// <summary>
			/// Variable <code>varLcCurrentMondayToAdd</code> that represents the Service Studio local variable
			///  <code>CurrentMondayToAdd</code> <p>Description: </p>
			/// </summary>
			public DateTime varLcCurrentMondayToAdd = new DateTime(1900, 1, 1, 0, 0, 0);

			/// <summary>
			/// Variable <code>varLcCurrentMonth</code> that represents the Service Studio local variable
			///  <code>CurrentMonth</code> <p>Description: </p>
			/// </summary>
			public int varLcCurrentMonth = 0;

			/// <summary>
			/// Variable <code>varLcNewMonth</code> that represents the Service Studio local variable
			///  <code>NewMonth</code> <p>Description: </p>
			/// </summary>
			public int varLcNewMonth = 0;

			public RCAcademicYear2Record resGetAcademicYearValues2_outParamAcademicYear = new RCAcademicYear2Record(null);

			public lcvGetDropDownValues() {
			}
		}
		public class lcoGetDropDownValues: VarsBag {
			public RLAttendancePeriodDropDownRecordList outParamStudentAttendanceDropDownList = new RLAttendancePeriodDropDownRecordList();

			public lcoGetDropDownValues() {
			}
		}
		/// <summary>
		/// Action <code>ActionGetDropDownValues</code> that represents the Service Studio user action
		///  <code>GetDropDownValues</code> <p> Description: </p>
		/// </summary>
		public static void ActionGetDropDownValues(HeContext heContext, out RLAttendancePeriodDropDownRecordList outParamStudentAttendanceDropDownList) {
			lcoGetDropDownValues result = new lcoGetDropDownValues();
			lcvGetDropDownValues localVars = new lcvGetDropDownValues();
			try {
				// GetAcademicYearValues2
				Actions.ActionGetAcademicYearValues2(heContext, ENAcademicYearType2Entity.GetRecordByKey(ObjectKey.Parse("8ZDe8cEZhk2DF16FIzuk9A")).ssId, "", out localVars.resGetAcademicYearValues2_outParamAcademicYear);
				localVars.varLcCurrentMondayToAdd = Convert.ToDateTime(BuiltInFunction.AddDays(BuiltInFunction.CurrDate(), ( - (BuiltInFunction.DayOfWeek(BuiltInFunction.CurrDate()) +6))).ToString("yyyy-M-d")); // CurrentMondayToAdd = AddDays
				localVars.varLcCurrentMonth = BuiltInFunction.Month(BuiltInFunction.CurrDate()); // CurrentMonth = Month
				localVars.varLcStartOfMonth = BuiltInFunction.TextToDate((((Convert.ToString(BuiltInFunction.Year(BuiltInFunction.CurrDate())) + "-") +Convert.ToString(BuiltInFunction.Month(BuiltInFunction.CurrDate()))) + "-01")); // StartOfMonth = TextToDate
				localVars.varLcStudentAttendanceDropDownRecord.ssSTAttendancePeriodDropDown.ssDateRange = ((localVars.varLcCurrentMondayToAdd.ToString(FormatInfo.GetOutputDateFormatString(), FormatInfo.defaultHeCultureInfo) + "|") +BuiltInFunction.AddDays(localVars.varLcCurrentMondayToAdd, 7).ToString(FormatInfo.GetOutputDateTimeFormatString(), FormatInfo.defaultHeCultureInfo)); // StudentAttendanceDropDownRecord.AttendancePeriodDropDown.DateRange = CurrentMondayToAdd + "|" + AddDays
				localVars.varLcStudentAttendanceDropDownRecord.ssSTAttendancePeriodDropDown.ssDescription = "Last Week"; // StudentAttendanceDropDownRecord.AttendancePeriodDropDown.Description = "Last Week"
				// ListAppend2
				ExtendedActions.ListAppend(heContext, result.outParamStudentAttendanceDropDownList, localVars.varLcStudentAttendanceDropDownRecord);
				localVars.varLcStudentAttendanceDropDownRecord.ssSTAttendancePeriodDropDown.ssDateRange = ((localVars.resGetAcademicYearValues2_outParamAcademicYear.ssENAcademicYear2.ssYYYY_MM_DD+ "|") +BuiltInFunction.CurrDate().ToString(FormatInfo.GetOutputDateFormatString(), FormatInfo.defaultHeCultureInfo)); // StudentAttendanceDropDownRecord.AttendancePeriodDropDown.DateRange =
				// GetAcademicYearValues2.AcademicYear.AcademicYear2.YYYY_MM_DD + "|" + CurrDate
				localVars.varLcStudentAttendanceDropDownRecord.ssSTAttendancePeriodDropDown.ssDescription = "Full Academic Year"; // StudentAttendanceDropDownRecord.AttendancePeriodDropDown.Description = "Full Academic Year"
				// ListAppend5
				ExtendedActions.ListAppend(heContext, result.outParamStudentAttendanceDropDownList, localVars.varLcStudentAttendanceDropDownRecord);
				localVars.varLcStudentAttendanceDropDownRecord.ssSTAttendancePeriodDropDown.ssDateRange = ((localVars.varLcStartOfMonth.ToString(FormatInfo.GetOutputDateFormatString(), FormatInfo.defaultHeCultureInfo) + "|") +BuiltInFunction.AddDays(BuiltInFunction.AddMonths(localVars.varLcStartOfMonth, 1), (-1)).ToString(FormatInfo.GetOutputDateTimeFormatString(), FormatInfo.defaultHeCultureInfo)); // StudentAttendanceDropDownRecord.AttendancePeriodDropDown.DateRange = StartOfMonth + "|" + AddDays
				localVars.varLcStudentAttendanceDropDownRecord.ssSTAttendancePeriodDropDown.ssDescription = ((Functions.ActionGetMonthName(heContext, BuiltInFunction.Month(localVars.varLcStartOfMonth)) + " ") +Convert.ToString(BuiltInFunction.Year(localVars.varLcStartOfMonth))); // StudentAttendanceDropDownRecord.AttendancePeriodDropDown.Description = GetMonthName(Month) + " " + Year
				// ListAppend3
				ExtendedActions.ListAppend(heContext, result.outParamStudentAttendanceDropDownList, localVars.varLcStudentAttendanceDropDownRecord);
				while ((localVars.varLcCurrentMondayToAdd>=BuiltInFunction.TextToDate(localVars.resGetAcademicYearValues2_outParamAcademicYear.ssENAcademicYear2.ssYYYY_MM_DD))) {
					localVars.varLcCurrentMondayToAdd = Convert.ToDateTime(BuiltInFunction.AddDays(localVars.varLcCurrentMondayToAdd, (-7)).ToString("yyyy-M-d")); // CurrentMondayToAdd = AddDays
					localVars.varLcNewMonth = BuiltInFunction.Month(localVars.varLcCurrentMondayToAdd); // NewMonth = Month
					if ((localVars.varLcCurrentMonth!=localVars.varLcNewMonth)) {
						localVars.varLcStartOfMonth = Convert.ToDateTime(BuiltInFunction.AddMonths(localVars.varLcStartOfMonth, (-1)).ToString("yyyy-M-d")); // StartOfMonth = AddMonths
						localVars.varLcCurrentMonth = localVars.varLcNewMonth; // CurrentMonth = NewMonth
						localVars.varLcStudentAttendanceDropDownRecord.ssSTAttendancePeriodDropDown.ssDateRange = ((localVars.varLcStartOfMonth.ToString(FormatInfo.GetOutputDateFormatString(), FormatInfo.defaultHeCultureInfo) + "|") +BuiltInFunction.AddDays(BuiltInFunction.AddMonths(localVars.varLcStartOfMonth, 1), (-1)).ToString(FormatInfo.GetOutputDateTimeFormatString(), FormatInfo.defaultHeCultureInfo)); // StudentAttendanceDropDownRecord.AttendancePeriodDropDown.DateRange = StartOfMonth + "|" + AddDays
						localVars.varLcStudentAttendanceDropDownRecord.ssSTAttendancePeriodDropDown.ssDescription = ((Functions.ActionGetMonthName(heContext, BuiltInFunction.Month(localVars.varLcStartOfMonth)) + " ") +Convert.ToString(BuiltInFunction.Year(localVars.varLcStartOfMonth))); // StudentAttendanceDropDownRecord.AttendancePeriodDropDown.Description = GetMonthName(Month) + " " + Year
						// ListAppend4
						ExtendedActions.ListAppend(heContext, result.outParamStudentAttendanceDropDownList, localVars.varLcStudentAttendanceDropDownRecord);

					}
					localVars.varLcStudentAttendanceDropDownRecord.ssSTAttendancePeriodDropDown.ssDateRange = ((localVars.varLcCurrentMondayToAdd.ToString(FormatInfo.GetOutputDateFormatString(), FormatInfo.defaultHeCultureInfo) + "|") +BuiltInFunction.AddDays(localVars.varLcCurrentMondayToAdd, 7).ToString(FormatInfo.GetOutputDateTimeFormatString(), FormatInfo.defaultHeCultureInfo)); // StudentAttendanceDropDownRecord.AttendancePeriodDropDown.DateRange = CurrentMondayToAdd + "|" + AddDays
					localVars.varLcStudentAttendanceDropDownRecord.ssSTAttendancePeriodDropDown.ssDescription = ("Week Commencing : " +BuiltInFunction.FormatFullDate(localVars.varLcCurrentMondayToAdd, "-")); // StudentAttendanceDropDownRecord.AttendancePeriodDropDown.Description = "Week Commencing : " + FormatFullDate
					// ListAppend
					ExtendedActions.ListAppend(heContext, result.outParamStudentAttendanceDropDownList, localVars.varLcStudentAttendanceDropDownRecord);
				}
			} // try

			catch (Exception exception) {
				ErrorLog.LogApplicationError(exception, heContext, "");
				Global.App.OsContext.Session["ExceptionMessage"] = exception.Message;
				heContext.LastException = exception;
				// Error Handler
				DatabaseAccess.RollbackAllTransactions();
				// ExceptionFeedbackMessage
				Actions.ActionFeedback_Message(heContext, ((string) Global.App.OsContext.Session["ExceptionMessage"]), ENMessageTypeEntity.GetRecordByKey(ObjectKey.Parse("htKb+xw1b0eZ4Wacii2S8w")).ssId);
				return;
			} // Catch
			finally {
				outParamStudentAttendanceDropDownList = result.outParamStudentAttendanceDropDownList;
			}
		}

		public static class FuncActionGetDropDownValues {


		}


	}


}